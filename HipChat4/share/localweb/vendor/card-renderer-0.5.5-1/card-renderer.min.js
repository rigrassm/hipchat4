!function(){var RENDER={link:function(locals,escape,include,rethrow){function encode_char(a){return _ENCODE_HTML_RULES[a]||a}rethrow=rethrow||function(a,b,c,d){var e=b.split("\n"),f=Math.max(d-3,0),g=Math.min(e.length,d+3),h=e.slice(f,g).map(function(a,b){var c=b+f+1;return(c==d?" >> ":"    ")+c+"| "+a}).join("\n");throw a.path=c,a.message=(c||"ejs")+":"+d+"\n"+h+"\n\n"+a.message,a},escape=escape||function(a){return void 0==a?"":String(a).replace(_MATCH_HTML,encode_char)};var _ENCODE_HTML_RULES={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},_MATCH_HTML=/[&<>'"]/g,__line=1,__lines='<div class="atlascard <%= locals._options.className %>" data-card="<%= JSON.stringify(locals.metaData) %>">\n    <% include views/thumbnail.ejs %>\n    <section class="meta">\n        <% include views/title-domain-description.ejs %>\n    </section>\n    <% include views/feedback.ejs %>\n</div>\n',__filename="cards/link.ejs";try{var __output=[],__append=__output.push.bind(__output);with(locals||{})__append('<div class="atlascard '),__append(escape(locals._options.className)),__append('" data-card="'),__append(escape(JSON.stringify(locals.metaData))),__append('">\n    '),__line=2,function(){-1==locals._options.className.indexOf("noimage")&&(__append('\n<figure class="thumbnail">\n    '),__line=3,locals.url&&(__append('\n    <a href="'),__line=4,__append(escape(locals.url)),__append('" target="_blank">\n    '),__line=5),__append('\n      <div class="thumbnail-wrapper">\n        <img '),__line=7,locals.thumbnailAspectClass&&(__append('\n        		class="'),__line=8,__append(escape(locals.thumbnailAspectClass)),__append('" \n        	 '),__line=9),__append(' src="'),__append(escape(locals.thumbnail.url)),__append('" alt="Thumbnail image" onerror="('),__append(escape(locals.thumbnailErrorCb)),__append(').call(this);">\n      </div>\n    '),__line=11,locals.url&&(__append("\n    </a>\n    "),__line=13),__append("\n</figure>\n"),__line=15),__append("\n"),__line=16}(),__append('\n    <section class="meta">\n        '),__line=4,function(){__append('<div class="title-wrapper">\n  '),__line=2;var a=getIconUrl(locals.icon);__append("\n  "),__line=3,a&&a.length>0&&(__append('\n  <img class="favicon" src="'),__line=4,__append(escape(a)),__append('" onerror="('),__append(escape(locals.faviconErrorCb)),__append(').call(this);">\n  '),__line=5),__append('\n  <div class="title-group">\n    <span class="title" title="'),__line=7,__append(escape(locals.title)),__append('">\n      '),__line=8,locals.url&&(__append('\n      <a href="'),__line=9,__append(escape(locals.url)),__append('" target="_blank">\n      '),__line=10),__append("\n        "),__line=11,__append(escape(locals.title)),__append("\n      "),__line=12,locals.url&&(__append("\n      </a>\n      "),__line=14),__append("\n    </span>\n    "),__line=16,locals.domain&&(__append('\n      <span class="subtitle" >'),__line=17,__append(escape(locals.domain)),__append("</span>\n    "),__line=18),__append("\n  </div>\n</div>\n"),__line=21,locals.descriptionHtml?(__append('\n<p class="description">'),__line=22,__append(locals.descriptionHtml),__append("</p>\n"),__line=23):locals.descriptionText&&(__append('\n<p class="description">'),__line=24,__append(escape(locals.descriptionText)),__append("</p>\n"),__line=25),__append("\n"),__line=26}(),__append("\n    </section>\n    "),__line=6,function(){if(locals.feedback){var a=locals.feedback;if(a.url&&a.label){if(__line=5,__append('\n      	<section class="feedback">\n        		<a href="'),__line=7,__append(escape(a.url)),__append('" \n        			'),__line=8,a.tooltip&&(__line=9,__append('title="'),__append(escape(a.tooltip)),__append('"')),a.data)for(var b in a.data)if(a.data.hasOwnProperty(b)){var c=a.data[b];"object"==typeof c&&(c=JSON.stringify(c)),__line=18,__append("data-"),__append(escape(b)),__append('="'),__append(escape(c)),__append('"')}__line=22,__append("\n        		 >"),__line=23,__append(escape(a.label)),__append("</a>\n      	</section>\n"),__line=25}}__line=27}(),__append("\n</div>\n"),__line=8;return __output.join("")}catch(e){rethrow(e,__lines,__filename,__line)}},application:function(locals,escape,include,rethrow){function encode_char(a){return _ENCODE_HTML_RULES[a]||a}rethrow=rethrow||function(a,b,c,d){var e=b.split("\n"),f=Math.max(d-3,0),g=Math.min(e.length,d+3),h=e.slice(f,g).map(function(a,b){var c=b+f+1;return(c==d?" >> ":"    ")+c+"| "+a}).join("\n");throw a.path=c,a.message=(c||"ejs")+":"+d+"\n"+h+"\n\n"+a.message,a},escape=escape||function(a){return void 0==a?"":String(a).replace(_MATCH_HTML,encode_char)};var _ENCODE_HTML_RULES={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},_MATCH_HTML=/[&<>'"]/g,__line=1,__lines='<div id="atlas-card-<%= locals.domId %>" class="atlascard <%= locals._options.className %>">\n  <% include views/activity.ejs %>\n  <% include views/thumbnail.ejs %>\n  <section class="meta">\n    <% include views/title-domain-description.ejs %>\n    <%\n    if (locals.attributes && locals.attributes.length) {\n    %>\n    <div class="application-attributes">\n      <%\n      for (var i = 0; i < locals.attributes.length;i++) {\n        var attribute = locals.attributes[i]; %>\n      <% include views/application-attribute.ejs %>\n      <% } %>\n    </div>\n    <% } %>\n  </section>\n  <% include views/feedback.ejs %>\n</div>\n\n',__filename="cards/application.ejs";try{var __output=[],__append=__output.push.bind(__output);with(locals||{}){if(__append('<div id="atlas-card-'),__append(escape(locals.domId)),__append('" class="atlascard '),__append(escape(locals._options.className)),__append('">\n  '),__line=2,function(){locals.activity&&(__append('\n\n    <div class="activity">\n\n        '),__line=5,locals.activity.icon&&(__append('\n            <img src="'),__line=6,__append(escape(locals.getIconUrl(locals.activity.icon))),__append('"\n                 class="activity-icon"/>\n        '),__line=8),__append('\n        <span class="activity-html">\n            '),__line=10,__append(locals.activity.html),__append('\n        </span>\n\n        <span class="aui-icon aui-icon-small aui-iconfont-arrows-down aui-expander-trigger activity-expander"\n              aria-controls="atlas-card-'),__line=14,__append(escape(locals.domId)),__append('"\n              onclick="$(this).toggleClass(\'aui-iconfont-arrows-up\')"></span>\n    </div>\n\n'),__line=18),__append("\n"),__line=19}(),__append("\n  "),__line=3,function(){-1==locals._options.className.indexOf("noimage")&&(__append('\n<figure class="thumbnail">\n    '),__line=3,locals.url&&(__append('\n    <a href="'),__line=4,__append(escape(locals.url)),__append('" target="_blank">\n    '),__line=5),__append('\n      <div class="thumbnail-wrapper">\n        <img '),__line=7,locals.thumbnailAspectClass&&(__append('\n        		class="'),__line=8,__append(escape(locals.thumbnailAspectClass)),__append('" \n        	 '),__line=9),__append(' src="'),__append(escape(locals.thumbnail.url)),__append('" alt="Thumbnail image" onerror="('),__append(escape(locals.thumbnailErrorCb)),__append(').call(this);">\n      </div>\n    '),__line=11,locals.url&&(__append("\n    </a>\n    "),__line=13),__append("\n</figure>\n"),__line=15),__append("\n"),__line=16}(),__append('\n  <section class="meta">\n    '),__line=5,function(){__append('<div class="title-wrapper">\n  '),__line=2;var a=getIconUrl(locals.icon);__append("\n  "),__line=3,a&&a.length>0&&(__append('\n  <img class="favicon" src="'),__line=4,__append(escape(a)),__append('" onerror="('),__append(escape(locals.faviconErrorCb)),__append(').call(this);">\n  '),__line=5),__append('\n  <div class="title-group">\n    <span class="title" title="'),__line=7,__append(escape(locals.title)),__append('">\n      '),__line=8,locals.url&&(__append('\n      <a href="'),__line=9,__append(escape(locals.url)),__append('" target="_blank">\n      '),__line=10),__append("\n        "),__line=11,__append(escape(locals.title)),__append("\n      "),__line=12,locals.url&&(__append("\n      </a>\n      "),__line=14),__append("\n    </span>\n    "),__line=16,locals.domain&&(__append('\n      <span class="subtitle" >'),__line=17,__append(escape(locals.domain)),__append("</span>\n    "),__line=18),__append("\n  </div>\n</div>\n"),__line=21,locals.descriptionHtml?(__append('\n<p class="description">'),__line=22,__append(locals.descriptionHtml),__append("</p>\n"),__line=23):locals.descriptionText&&(__append('\n<p class="description">'),__line=24,__append(escape(locals.descriptionText)),__append("</p>\n"),__line=25),__append("\n"),__line=26}(),__append("\n    "),__line=6,locals.attributes&&locals.attributes.length){__line=8,__append('\n    <div class="application-attributes">\n      '),__line=10;for(var i=0;i<locals.attributes.length;i++){var attribute=locals.attributes[i];__line=12,__append("\n      "),__line=13,function(){if(__append('<div class="application-field">\n    '),__line=2,attribute.label&&(__append('\n      <span class="application-label">'),__line=3,__append(escape(attribute.label)),__append(":</span>\n    "),__line=4),__append("\n    "),__line=5,attribute.value){var a=attribute.value;__line=6,__append('\n    <span class="application-value">\n        '),__line=8,a.icon&&(__append(' <img width="14" height="14" class="application-icon" src="'),__append(escape(locals.getIconUrl(a.icon))),__append('"/>\n        '),__line=9),a.label&&(a.url?(__line=10,__append('\n        <a href="'),__line=11,__append(escape(a.url)),__append('"><strong>'),__append(escape(a.label)),__append("</strong></a>\n        "),__line=12):a.style?0==a.style.indexOf("lozenge")&&(__line=13,__append('\n        <span class="aui-lozenge aui-'),__line=14,__append(escape(a.style)),__append('">'),__append(escape(a.label)),__append("</span>\n        "),__line=15):(__line=16,__append(" "),__append(escape(a.label))),__append("\n        "),__line=17),__append("\n    </span>\n    "),__line=19}__append("\n</div>\n"),__line=21}(),__append("\n      "),__line=14}__append("\n    </div>\n    "),__line=16}__append("\n  </section>\n  "),__line=18,function(){if(locals.feedback){var a=locals.feedback;if(a.url&&a.label){if(__line=5,__append('\n      	<section class="feedback">\n        		<a href="'),__line=7,__append(escape(a.url)),__append('" \n        			'),__line=8,a.tooltip&&(__line=9,__append('title="'),__append(escape(a.tooltip)),__append('"')),a.data)for(var b in a.data)if(a.data.hasOwnProperty(b)){var c=a.data[b];"object"==typeof c&&(c=JSON.stringify(c)),__line=18,__append("data-"),__append(escape(b)),__append('="'),__append(escape(c)),__append('"')}__line=22,__append("\n        		 >"),__line=23,__append(escape(a.label)),__append("</a>\n      	</section>\n"),__line=25}}__line=27}(),__append("\n</div>\n\n"),__line=21}return __output.join("")}catch(e){rethrow(e,__lines,__filename,__line)}}},ID_ALPHABET="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),ID_LENGTH=16,IMAGE_ASPECT=16/9,MIN_IMAGE_SIZES={compact:{width:162,height:92},small:{width:162,height:92},"default":{width:250,height:162}},generateUniqueDomId=function(){for(var a="",b=0;ID_LENGTH>b;b++)a+=ID_ALPHABET[Math.floor(Math.random()*ID_ALPHABET.length)];return a},hideFavicon=function(){this.parentElement.parentElement.parentElement.parentElement.className+=" no-favicon",this.parentElement.removeChild(this)},hideThumbnail=function(){this.parentElement.parentElement.parentElement.parentElement.className+=" no-thumbnail",this.parentElement.removeChild(this)},resolution=function(){return"devicePixelRatio"in window?window.devicePixelRatio:1},getIconUrl=function(a){return"string"==typeof a?a:"object"==typeof a?resolution()>1&&a["url@2x"]?a["url@2x"]:a.url:void 0},minifyFunctionString=function(a){return a.replace(/\n/g,"").replace(/\s+/g," ")},sanitizeDate=function(a){var b=new Date(1e3*a);if(b.getTime())return[b.toLocaleDateString("en-EN"),b.toLocaleTimeString("en-EN",{hour:"2-digit",minute:"2-digit"})].join(" - ")},deriveThumbnailAspectClass=function(a){if(a){var b=a.width,c=a.height;if(b&&c){var d=b/c;if(d>IMAGE_ASPECT)return"wide"}}return""},CardDrawer=function(a,b){var c={type:"link"};this.options=this._extend(c,b),this.metaData=this._extend({icon:{url:null}},a)};CardDrawer.prototype.render=function(a){a=this._extend(this.options,a);var b=this._prepareTemplateLocals(a);b.faviconErrorCb=minifyFunctionString(hideFavicon.toString()),b.thumbnailErrorCb=minifyFunctionString(hideThumbnail.toString()),b.thumbnailAspectClass=deriveThumbnailAspectClass(b.thumbnail),b.hideThumb=this._isThumbnailTooSmall(a.format,b.thumbnail),b.getIconUrl=getIconUrl,b.domId=generateUniqueDomId(),b.metaData=this.metaData,b.feedback=a.feedback,this._setClassName(b),this._setDomain(b),this._parseDescription(b);var c="";try{RENDER[a.type]||(console.warn(" Card type ["+a.type+"] does not exist, default to link"),a.type="link"),c=RENDER[a.type](b)}catch(d){console.log(d)}return c},CardDrawer.prototype.draw=function(a,b){var c=document.querySelector(a);c.innerHTML=this.render(b)},CardDrawer.prototype._prepareTemplateLocals=function(a){var b=JSON.parse(JSON.stringify(this.metaData));return b.date=sanitizeDate(b.date),b._options=a,b},CardDrawer.prototype._extend=function(a,b){var c,d={};for(c in a)Object.prototype.hasOwnProperty.call(a,c)&&(d[c]=a[c]);for(c in b)Object.prototype.hasOwnProperty.call(b,c)&&(d[c]=b[c]);return d},CardDrawer.prototype._setClassName=function(a){var b=[];b.push(a._options.format),a.activity&&b.push("aui-expander-content"),!a.thumbnail||!a.thumbnail.url||a.hideThumb||a._options.noThumb?b.push("noimage"):b.push("image"),a.icon&&a.icon.url||b.push("nofavicon"),"application"===a._options.type&&a.attributes&&a.attributes.length&&b.push("attributes"),a._options.className=b.join(" ")},CardDrawer.prototype._setDomain=function(a){if(!a.domain&&a.url){var b=a.url.indexOf("://");if(b>=0){var c=a.url.substr(b+3),d=c.indexOf("/");d>=0&&(c=c.substr(0,d)),a.domain=c}}},CardDrawer.prototype._parseDescription=function(a){"object"==typeof a.description?"html"===a.description.format?a.descriptionHtml=a.description.value:a.descriptionText=a.description.value:a.descriptionText=a.description},CardDrawer.prototype._isThumbnailTooSmall=function(a,b){if(b){var c=b.width,d=b.height;if(void 0===c||void 0===d)return!1;var e=CardDrawer._getMinImageSizes(a);return c<e.width||d<e.height}return!0},CardDrawer._getMinImageSizes=function(a){var b=MIN_IMAGE_SIZES[a];return b||(b=MIN_IMAGE_SIZES["default"]),b},"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(module.exports=CardDrawer),exports.CardDrawer=CardDrawer):this.CardDrawer=CardDrawer}();